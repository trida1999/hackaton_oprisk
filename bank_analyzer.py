from crewai import Agent, Task, Crew, Process
from langchain_openai import ChatOpenAI
from typing import Type, Optional, Dict, List
import json
from crewai.tools import tool
from striprtf.striprtf import rtf_to_text
import chardet

import os
from dotenv import load_dotenv

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

import logging
logging.basicConfig(level=logging.INFO)

# ----------------------------
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LLM
# ----------------------------

#llm = ChatOpenAI(
#    openai_api_base="https://openrouter.ai/api/v1",
#    openai_api_key="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",
#    model_name="qwen/qwen3-4b:free"
#)

llm = ChatOpenAI(
    model="openrouter/qwen/qwen3-14b:free",
    #model="openrouter/qwen/qwen2.5-vl-72b-instruct:free",
    openai_api_base="https://openrouter.ai/api/v1",
    openai_api_key=os.getenv("OPENROUTER_API_KEY"),
    temperature=0.3,
    headers={
        "HTTP-Referer": "",  # –£–∫–∞–∂–∏—Ç–µ –≤–∞—à URL
        "X-Title": ""  # –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    }
)

def read_rtf(file_path):
    print(f"–ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: {file_path}")
    with open(file_path, 'rb') as file:
        raw_content = file.read()

        encoding = chardet.detect(raw_content)['encoding']
        try:
            decoded_content = raw_content.decode(encoding or 'cp1251')
        except UnicodeDecodeError:
            decoded_content = raw_content.decode('cp1251', errors='replace')

    text = rtf_to_text(decoded_content)
    print(f"read symbols: {len(text)}");
    return text

# ----------------------------
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å–ø–æ—Å–æ–±)
# ----------------------------

# –°–ø–æ—Å–æ–± 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ @tool (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
@tool
def access_data_files(file_name: str) -> Dict:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ data (companies.json –∏–ª–∏ reviews.json)"""
    with open(file_name, 'r', encoding='utf-8') as f:
        return json.load(f)

@tool
def access_risk_methodology() -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ 716-–ü –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ä–∏—Å–∫—É"""
    #–æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π —Ç–µ–∫—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞, –æ–Ω –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç 40–ö
    #return read_rtf('data/–ü–æ–ª–æ–∂–µ–Ω–∏–µ_–ë–∞–Ω–∫–∞_–†–æ—Å—Å–∏–∏_–æ—Ç_08_04_2020_N_716_–ü_—Ä–µ–¥_–æ—Ç_25_03_1.rtf')
    return """
    –ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (Unsuitable selling).
–ü—Ä–æ–¥–∞–∂–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–ª–∏ —É—Å–ª—É–≥, –Ω–µ –æ—Ç–≤–µ—á–∞—é—â–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤.

–ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–º –∏ —É—è–∑–≤–∏–º—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∫–ª–∏–µ–Ω—Ç–æ–≤
‚Ä¢	–ü—Ä–æ–¥–∞–∂–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—â–∏—Ö –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ, —Å–æ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Å–ª–æ—è–º –Ω–∞—Å–µ–ª–µ–Ω–∏—è –∏ –≥—Ä–∞–∂–¥–∞–Ω–∞–º –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞. –ü—Ä–∏ –¥–æ—Å—Ä–æ—á–Ω–æ–º –≤—ã—Ö–æ–¥–µ –∏–∑ —Ç–∞–∫–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É–º–º–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.
‚Ä¢	–ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º —Ä–∏—Å–∫–∞ –±–µ–∑ –æ—Ü–µ–Ω–∫–∏ –∞–ø–ø–µ—Ç–∏—Ç–∞ –∫ —Ä–∏—Å–∫—É –∫–ª–∏–µ–Ω—Ç–∞.
–ü—Ä–æ–¥–∞–∂–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ª–∏—Ü–∞–º, –Ω–µ –æ–±–ª–∞–¥–∞—é—â–∏–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –æ–ø—ã—Ç–æ–º –∏ –∑–Ω–∞–Ω–∏—è–º–∏
‚Ä¢	–ü—Ä–æ–¥–∞–∂–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≥—Ä–∞–∂–¥–∞–Ω–∞–º, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π (–æ–ø—ã—Ç–∞) —Ä–∞–±–æ—Ç—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏—Ö –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.
‚Ä¢	–ü—Ä–æ–¥–∞–∂–∞ –≥—Ä–∞–∂–¥–∞–Ω–∞–º —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–µ–∑ –æ—Ü–µ–Ω–∫–∏ –∏–ª–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∑–Ω–∞–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞.

–ù–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (Mispricing)
–í–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–º–∏—Å—Å–∏–π, —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏) —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ —É—Å–ª—É–≥–∏.
–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —É—Å–ª—É–≥ —Å–æ —Å–∫—Ä—ã—Ç—ã–º–∏ –∏ –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏ –∫–æ–º–∏—Å—Å–∏—è–º–∏
‚Ä¢	–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–≤–æ–π–Ω—ã—Ö –∫–æ–º–∏—Å—Å–∏–π –≤ —Å–≤—è–∑–∏ —Å –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ–º –æ–¥–Ω–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ —É—Å–ª—É–≥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∑–∏–º–∞–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–µ–≤—ã–º –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–º —Ñ–æ–Ω–¥–æ–º –Ω–∞—Ä—è–¥—É —Å –∫–æ–º–∏—Å—Å–∏–µ–π –∑–∞ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–º –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤, –≤ —Å–æ—Å—Ç–∞–≤ –∞–∫—Ç–∏–≤–æ–≤ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–∞—é—Ç—Å—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞–∏ —Ñ–æ–Ω–¥–∞).
–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —É—Å–ª—É–≥, —Ü–µ–Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ä–∞–∑–º–µ—Ä –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–∏, –ø—Ä–µ–º–∏–∏, –∫–æ–º–∏—Å—Å–∏–∏ –∏ –¥—Ä—É–≥–æ–µ) –∫–æ—Ç–æ—Ä—ã—Ö —É—â–µ–º–ª—è—é—Ç –∏–Ω—Ç–µ—Ä–µ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞
‚Ä¢	–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ —É—Å–ª—É–≥–∏, —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö (–∫–æ–º–∏—Å—Å–∏–∏ –ø–æ –∫–æ—Ç–æ—Ä—ã–º) —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –Ω–∞ —Ä—ã–Ω–∫–µ (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫–ª—é—á–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä —Å –≤–∑–∏–º–∞–Ω–∏–µ–º –∑–∞–≤—ã—à–µ–Ω–Ω–æ–π –ø—Ä–µ–º–∏–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—ã–∫—É–ø–∞ –ª–∏–∫–≤–∏–¥–Ω—ã—Ö —Ü–µ–Ω–Ω—ã—Ö –±—É–º–∞–≥ –Ω–∞ –≤–Ω–µ–±–∏—Ä–∂–µ–≤–æ–º —Ä—ã–Ω–∫–µ –ø–æ –∑–∞–Ω–∏–∂–µ–Ω–Ω–æ–π —Ü–µ–Ω–µ, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ —Å –∑–∞–≤—ã—à–µ–Ω–Ω—ã–º–∏ –∫–æ–º–∏—Å—Å–∏—è–º–∏).
‚Ä¢	–ù–µ—Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏–µ –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–ª–∏ —É—Å–ª—É–≥–∏, –∞ —Ç–∞–∫–∂–µ –æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–∞—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∏—Ö –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ–º –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
‚Ä¢	–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –±–µ–∑ —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –µ–∂–µ–≥–æ–¥–Ω—ã–π –≤–∑–Ω–æ—Å.
–ù–∞–≤—è–∑—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ —Ü–µ–ª—è—Ö –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∏—Å—Å–∏–π (Churning)
‚Ä¢	–ù–∞–≤—è–∑—ã–≤–∞–Ω–∏–µ –±—Ä–æ–∫–µ—Ä–æ–º –∏–ª–∏ –∞–≥–µ–Ω—Ç–æ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—É—Å–ª—É–≥) —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–æ–∫ –∑–∞ —Å—á–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ü–µ–ª—è—Ö —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–æ–º–∏—Å—Å–∏–∏ (–∞–≥–µ–Ω—Ç—Å–∫–æ–≥–æ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è), –Ω–µ –∏–º–µ—é—â–∏—Ö —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.


–°–≤—è–∑–∞–Ω–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞ (Tied selling)
–ü—Ä–∞–∫—Ç–∏–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –∏–ª–∏ —É—Å–ª—É–≥—É –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –ø–æ–∫—É–ø–∞–µ—Ç –∫–∞–∫–æ–π-–ª–∏–±–æ –¥—Ä—É–≥–æ–π –ø—Ä–æ–¥—É–∫—Ç –∏–ª–∏ —É—Å–ª—É–≥—É.
‚Ä¢	–í–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ –æ–± –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º –ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –∑–∞–π–º–∞.
‚Ä¢	–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
‚Ä¢	–í–∫–ª—é—á–µ–Ω–∏–µ –≤ –¥–æ–≥–æ–≤–æ—Ä –Ω–∞ –æ–∫–∞–∑–∞–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –¥–µ–ø–æ–∑–∏—Ç–∞—Ä–Ω—ã—Ö –∏ –±—Ä–æ–∫–µ—Ä—Å–∫–∏—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
‚Ä¢	–ù–µ–æ—Ç—Ä–∞–∂–µ–Ω–∏–µ –≤ –∑–∞—è–≤–ª–µ–Ω–∏–∏ –æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç–Ω–æ–π —É—Å–ª—É–≥–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—É—é –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É.

–ü–æ–¥–º–µ–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ (Misselling)
–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ (—É—Å–ª—É–≥–∏) –ø–æ–¥ –≤–∏–¥–æ–º –¥—Ä—É–≥–æ–≥–æ.
‚Ä¢	–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∏–ª–∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–æ–¥ –≤–∏–¥–æ–º –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –≤–∫–ª–∞–¥–∞.
‚Ä¢	–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É—Å–ª—É–≥ –∫–æ–º–ø–∞–Ω–∏–π, –Ω–µ –∏–º–µ—é—â–∏—Ö –ª–∏—Ü–µ–Ω–∑–∏—é –ë–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏ (–Ω–µ –≤—Ö–æ–¥—è—â–∏—Ö –≤ —Ä–µ–µ—Å—Ç—Ä –ë–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏), –ø–æ–¥ –≤–∏–¥–æ–º –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

    """

# ----------------------------
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤
# ----------------------------
senior_analyst = Agent(
    role='–°—Ç–∞—Ä—à–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö',
    goal='–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤–æ–≤ –∏ –≤—ã—è–≤–ª—è—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏',
    backstory='–û–ø—ã—Ç–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ —Å 10-–ª–µ—Ç–Ω–∏–º —Å—Ç–∞–∂–µ–º –≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π —Å—Ñ–µ—Ä–µ',
    tools=[access_data_files],
    llm=llm,
    verbose=True
)

risk_assistant = Agent(
    role='–†–∏—Å–∫-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç',
    goal='–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤',
    backstory='–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Ä–∏—Å–∫–∞–º–∏ —Å –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ 716-–ü '
              '–∏ –æ–ø—ã—Ç–æ–º –≤—ã—è–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π —Å—Ñ–µ—Ä–µ.',
    tools=[access_data_files, access_risk_methodology],
    verbose=True,
    allow_delegation=False,
    llm = llm
)

insights_agent = Agent(
    role='–ê–≥–µ–Ω—Ç –≤—ã—è–≤–ª–µ–Ω–∏—è –∏–Ω—Å–∞–π—Ç–æ–≤',
    goal='–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–∏–µ –≤—ã–≤–æ–¥—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª–µ–Ω–∏—é –±–∞–Ω–∫–∞',
    backstory='–≠–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–ø–æ—Å–æ–±–Ω—ã–π –≤—ã–¥–µ–ª—è—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–µ '
              '–∞—Å–ø–µ–∫—Ç—ã –∏–∑ –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∏—Ö –≤ —Å–∂–∞—Ç–æ–º –≤–∏–¥–µ.',
    verbose=True,
    allow_delegation=False,
    llm = llm
)

report_builder = Agent(
    role='–ê–≥–µ–Ω—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤',
    goal='–°–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤',
    backstory='–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å —Å –æ–ø—ã—Ç–æ–º –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö '
              '–æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –≤—ã—Å—à–µ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –±–∞–Ω–∫–∞.',
    verbose=True,
    allow_delegation=False,
    llm = llm
)

critic = Agent(
    role='–ö—Ä–∏—Ç–∏–∫',
    goal='–û—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø–æ–ª–Ω–æ—Ç—É –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–≤–æ–¥–æ–≤, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥—Ä—É–≥–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏',
    backstory='–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π —ç–∫—Å–ø–µ—Ä—Ç —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –º—ã—à–ª–µ–Ω–∏–µ–º, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å '
              '–∫–∞—á–µ—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø–µ—Ä–µ–¥ –∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É.',
    verbose=True,
    allow_delegation=False,
    llm = llm
)

# ----------------------------
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á
# ----------------------------

def create_analysis_tasks(question: str) -> List[Task]:
    """–°–æ–∑–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π"""
    
    # –ó–∞–¥–∞—á–∞ –¥–ª—è —Å—Ç–∞—Ä—à–µ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
    data_analysis_task = Task(
        description=f"""
        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤–æ–≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –∏ –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é —Å–ø—Ä–∞–≤–∫—É.
        –í–æ–ø—Ä–æ—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: {question}
        
        –í –≤–∞—à–µ–º –∞–Ω–∞–ª–∏–∑–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
        1. –°—Ä–µ–¥–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª–µ–Ω–∏—é
        2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤ (–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ, –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ)
        3. –î–∏–Ω–∞–º–∏–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        4. –í—ã—è–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–π —Å –ª—É—á—à–∏–º–∏ –∏ —Ö—É–¥—à–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
        """,
        agent=senior_analyst,
        expected_output="""
        –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π:
        - –°—Ä–µ–¥–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ –æ—Ç–¥–µ–ª–µ–Ω–∏—è–º
        - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∑—ã–≤–æ–≤
        - –î–∏–Ω–∞–º–∏–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫ —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏
        - –†–µ–π—Ç–∏–Ω–≥ –æ—Ç–¥–µ–ª–µ–Ω–∏–π –æ—Ç –ª—É—á—à–µ–≥–æ –∫ —Ö—É–¥—à–µ–º—É
        """
    )

    # –ó–∞–¥–∞—á–∞ –¥–ª—è —Ä–∏—Å–∫-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
    risk_analysis_task = Task(
        description=f"""
        –ù–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏ 
        –∏ —Å–ª—É—á–∞–∏ –Ω–µ–¥–æ–±—Ä–æ—Å–æ–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è—Ö.
        –í–æ–ø—Ä–æ—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: {question}
        
        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é 716-–ü –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤.
        –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–∏—Ç–µ:
        1. –ñ–∞–ª–æ–±–∞–º –Ω–∞ –Ω–∞–≤—è–∑—ã–≤–∞–Ω–∏–µ —É—Å–ª—É–≥
        2. –°–∫—Ä—ã—Ç—ã–º –∫–æ–º–∏—Å—Å–∏—è–º –∏ –ø–ª–∞—Ç–µ–∂–∞–º
        3. –ù–µ–∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Å–±–æ—è–º
        """,
        agent=risk_assistant,
        expected_output="""
        –û—Ç—á–µ—Ç –æ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∏—Å–∫–∞—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
        - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é —Ä–∏—Å–∫–æ–≤ –ø–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ 716-–ü
        - –°–ø–∏—Å–æ–∫ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
        - –û—Ç–¥–µ–ª–µ–Ω–∏—è —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∂–∞–ª–æ–±
        - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–Ω–∏–∂–µ–Ω–∏—é —Ä–∏—Å–∫–æ–≤
        """
    )

    # –ó–∞–¥–∞—á–∞ –¥–ª—è –∞–≥–µ–Ω—Ç–∞ –∏–Ω—Å–∞–π—Ç–æ–≤
    insights_task = Task(
        description=f"""
        –ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏ –≤—ã–≤–æ–¥—ã 
        –ø–æ –∫–∞–∂–¥–æ–º—É –±–∞–Ω–∫–æ–≤—Å–∫–æ–º—É –æ—Ç–¥–µ–ª–µ–Ω–∏—é.
        –í–æ–ø—Ä–æ—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: {question}
        
        –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞:
        1. –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª–µ–Ω–∏—è
        2. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
        3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
        """,
        agent=insights_agent,
        expected_output="""
        –ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç —Å –∫–ª—é—á–µ–≤—ã–º–∏ –≤—ã–≤–æ–¥–∞–º–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª–µ–Ω–∏—é, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
        - –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–ª—å–Ω—ã–µ –∏ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
        - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
        - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
        """
    )

    # –ó–∞–¥–∞—á–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
    report_task = Task(
        description=f"""
        –ù–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –≤—Å–µ—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç, 
        –æ—Ç–≤–µ—á–∞—é—â–∏–π –Ω–∞ –≤–æ–ø—Ä–æ—Å: {question}
        
        –û—Ç—á–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
        1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º
        2. –°–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã
        3. –í–∫–ª—é—á–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
        4. –ë—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ —Ç–æ–ø-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É
        """,
        agent=report_builder,
        expected_output="""
        –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
        - –û—Ç–≤–µ—Ç –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –≤–æ–ø—Ä–æ—Å
        - –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã
        - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
        - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
        """
    )

    # –ó–∞–¥–∞—á–∞ –¥–ª—è –∫—Ä–∏—Ç–∏–∫–∞
    critique_task = Task(
        description=f"""
        –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –æ—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞, –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π.
        –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
        1. –ü–æ–ª–Ω–æ—Ç—É –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å: {question}
        2. –û–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–æ–≤
        3. –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
        4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        
        –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é –∫—Ä–∏—Ç–∏–∫—É –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é.
        """,
        agent=critic,
        expected_output="""
        –û—Ç—á–µ—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
        - –û—Ü–µ–Ω–∫—É –ø–æ–ª–Ω–æ—Ç—ã –∏ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
        - –ö—Ä–∏—Ç–∏–∫—É —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –≤ –∞–Ω–∞–ª–∏–∑–µ
        - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
        - –û–±—â—É—é –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–º–∞–Ω–¥—ã
        """
    )

    return [data_analysis_task, risk_analysis_task, insights_task, report_task, critique_task]

# ----------------------------
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
# ----------------------------

def analyze_bank_reviews(question: str):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π"""
    
    # –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏
    tasks = create_analysis_tasks(question)

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É –∞–≥–µ–Ω—Ç–æ–≤
    crew = Crew(
        agents=[senior_analyst, risk_assistant, insights_agent, report_builder, critic],
        tasks=tasks,
        process=Process.sequential  # –ó–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
    )
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
    result = crew.kickoff()
    
    return result

# ----------------------------
# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
# ----------------------------
if __name__ == "__main__":
    try:

        print("üöÄ –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞...")
        result = analyze_bank_reviews("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ reviews.json –∏ –Ω–∞–π–¥–∏—Ç–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞ –≤ –æ—Ç–¥–µ–ª–µ–Ω–∏—è—Ö")
        #result = crew.kickoff()
        print("\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç:", result)

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")